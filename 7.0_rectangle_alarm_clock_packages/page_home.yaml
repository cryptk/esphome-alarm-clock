# globals:
#   - id: global_time_format
#     type: std::string
#     restore_value: yes
#     initial_value: '"%I:%M"'

script:
  - id: show_time_display
    then:
    - script.execute: update_time_display
    - lvgl.label.update:
        id: time_background
        hidden: false
    - lvgl.label.update:
        id: time_label
        hidden: false

  # - id: update_time_display
  #   then:
  #     - lvgl.label.update:
  #         id: time_label
  #         text:
  #           time_format: !lambda |-
  #             return id(global_time_format).c_str();
  #           time: !lambda 'return id(sntp_time).now();'

  - id: update_time_display
    then:
      if:
        condition:
          - switch.is_on: switch_show_seconds
        then:
          - lvgl.label.update:
              id: time_label
              text:
                time_format: '%I:%M:%S'
                time: !lambda 'return id(sntp_time).now();'
        else:
          - lvgl.label.update:
              id: time_label
              text:
                time_format: "%I:%M"
                time: !lambda 'return id(sntp_time).now();'

lvgl:
  id: lvgl_main
  disp_bg_color: 0x000000
  disp_bg_opa: COVER
  pages:
    - id: home
      styles: page_background
      widgets:
        - label:
            align: CENTER
            id: time_background
            text_font: seven_segment
            text_color: seven_segment_off
        - label:
            align: CENTER
            id: time_label
            text: startup
            text_font: seven_segment
            text_color: seven_segment_on